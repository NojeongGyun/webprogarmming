<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ì„¸ìš”ìˆ˜ì œë””ì €íŠ¸ ì¹´í˜</title>
    <meta name="description" content="ë”°ëœ»í•˜ê³  ë§›ìˆëŠ” ìˆ˜ì œ ë””ì €íŠ¸ì™€ ìŒë£Œë¥¼ ì¦ê¸°ì‹¤ ìˆ˜ ìˆëŠ” ì˜¤ì„¸ìš” ì¹´í˜ì…ë‹ˆë‹¤">
    
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700&family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        /* ê¸°ë³¸ ìŠ¤íƒ€ì¼ ë° ë¦¬ì…‹ */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            /* ìƒˆ ë°°ê²½ ìŠ¤íƒ€ì¼ */
            font-family: 'Noto Sans KR', sans-serif; /* ì „ì²´ í°íŠ¸ ë³€ê²½ */
            background: linear-gradient(to bottom right, hsl(35, 25%, 96%), hsl(45, 30%, 92%)); /* ë¶€ë“œëŸ¬ìš´ ë² ì´ì§€ ê·¸ë¼ë°ì´ì…˜ */
            background-attachment: fixed; /* ìŠ¤í¬ë¡¤ ì‹œ ë°°ê²½ ê³ ì • */
            color: hsl(25, 35%, 15%);
            line-height: 1.6;
            display: flex;
            min-height: 100vh;
            flex-direction: column;
            
            /* ë°°ê²½ì— ì€ì€í•œ í…ìŠ¤ì²˜ ì¶”ê°€ (ì„ íƒ ì‚¬í•­) */
            /* background-image: url('data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iNDAiIHZpZXdCb3g9IjAgMCA0MC å¯æ„›cE9MIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHxnIGZpbGw9IiMwMDAwMDAiIGZpbGwtb3BhY2l0eT0iMC4wNSI+PHBhdGggZD0iTTktNGwxMSAxMVY0LjI1TDQuMjUgOWg0Ljc1eiIvPjwvZz48L2c+PC9zdmc+'); */
        }

        /* í—¤ë” ìŠ¤íƒ€ì¼ */
        header {
            /* ìƒˆ í—¤ë” ë°°ê²½ ìŠ¤íƒ€ì¼ */
            background: linear-gradient(to right, hsl(25, 45%, 45%), hsl(35, 55%, 35%)); /* ê³ ê¸‰ìŠ¤ëŸ¬ìš´ ê°ˆìƒ‰ ê·¸ë¼ë°ì´ì…˜ */
            color: hsl(30, 20%, 98%);
            padding: 2.5rem 1rem; /* íŒ¨ë”© ì¦ê°€ */
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2); /* ê·¸ë¦¼ì ê°•í™” */
            position: sticky; /* ìƒë‹¨ ê³ ì • */
            top: 0;
            z-index: 1000; /* ë‹¤ë¥¸ ìš”ì†Œ ìœ„ì— ì˜¤ë„ë¡ ì„¤ì • */
        }

        header h1 {
            font-family: 'Playfair Display', serif; /* íƒ€ì´í‹€ í°íŠ¸ ë³€ê²½ */
            text-align: center;
            font-size: 3.5rem; /* í°íŠ¸ í¬ê¸° ì¦ê°€ */
            margin-bottom: 0.75rem; /* ì—¬ë°± ì¦ê°€ */
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3); /* í…ìŠ¤íŠ¸ ê·¸ë¦¼ì */
            letter-spacing: 0.1rem; /* ìê°„ ì¡°ì ˆ */
        }

        header p {
            font-family: 'Noto Sans KR', sans-serif; /* ë¶€ì œëª© í°íŠ¸ */
            text-align: center;
            font-size: 1.25rem; /* í°íŠ¸ í¬ê¸° ì¦ê°€ */
            opacity: 0.9;
            font-weight: 300; /* ì–‡ì€ ê¸€ì”¨ */
            letter-spacing: 0.05rem; /* ìê°„ ì¡°ì ˆ */
            color: hsl(30, 20%, 90%); /* ì‚´ì§ ì–´ë‘ìš´ í°ìƒ‰ */
        }

        .main-wrapper {
            display: flex;
            flex-grow: 1;
            max-width: 1600px;
            margin: 3rem auto;
            padding: 0 1rem;
            width: 100%;
        }

        .container {
            flex: 3;
            padding-right: 2rem;
        }

        /* --- ì‚¬ì´ë“œë°” ì»¨í…Œì´ë„ˆ ìŠ¤íƒ€ì¼ --- */
        #sidebar {
            flex: 1;
            position: sticky;
            top: 8rem; /* í—¤ë” ë†’ì´ ê³ ë ¤í•˜ì—¬ ì¡°ì • */
            align-self: flex-start;
            height: fit-content;
        }
        
        /* --- ì˜¤ëŠ˜ì˜ ê³„ì‚°ì™• ì„¹ì…˜ ìŠ¤íƒ€ì¼ --- */
        #calculator-section {
            padding: 1.5rem;
            background-color: hsl(30, 20%, 98%);
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid hsl(35, 60%, 70%);
            margin-bottom: 1.5rem;
        }

        #calculator-section h2 {
            font-size: 1.5rem;
            color: hsl(25, 45%, 40%);
            margin-bottom: 1rem;
            border-bottom: 2px solid hsl(35, 60%, 70%);
            padding-bottom: 0.5rem;
        }
        
        /* ì¸ì› ìˆ˜ ì…ë ¥ í•„ë“œ ìŠ¤íƒ€ì¼ */
        .input-group {
            margin-bottom: 1rem;
        }

        .input-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-size: 1rem;
            font-weight: bold;
            color: hsl(25, 35%, 15%);
        }

        .input-group input[type="number"] {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid hsl(35, 60%, 70%);
            border-radius: 0.5rem;
            font-size: 1rem;
            text-align: center;
        }

        .confirm-button {
            width: 100%;
            padding: 0.75rem;
            background-color: hsl(35, 60%, 70%);
            color: hsl(25, 35%, 15%);
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s;
            margin-bottom: 0.5rem;
        }
        
        .confirm-button.present {
            background-color: hsl(25, 45%, 50%);
            color: white;
        }

        .confirm-button:hover {
            background-color: hsl(35, 70%, 60%);
        }
        
        .confirm-button.present:hover {
            background-color: hsl(25, 60%, 60%);
        }
        
        /* --- ì•ŒíŒŒë²³ í‘œì‹œ ì˜ì—­ ìŠ¤íƒ€ì¼ --- */
        #participant-display-area {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid hsl(35, 60%, 70%);
            text-align: center;
            font-weight: 500;
        }

        /* ì œì‹œëœ ëª¨ë“  ì•ŒíŒŒë²³ì„ ë³´ì—¬ì£¼ëŠ” íŒ”ë ˆíŠ¸ */
        .participant-palette {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin-top: 0.75rem;
            margin-bottom: 1.5rem;
            min-height: 30px;
        }

        /* íŒ”ë ˆíŠ¸ì˜ ê°œë³„ ì•ŒíŒŒë²³ ìŠ¤ì™€ì¹˜ */
        .participant-swatch {
            width: 30px;
            height: 30px;
            border-radius: 5px;
            border: 2px solid white;
            box-shadow: 0 1px 3px rgba(0,0,0,0.2);
            transition: all 0.3s ease-in-out;
            cursor: default;
            background-color: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: #333;
            font-size: 1.1rem;
        }
        
        /* ìµœì¢… ì„ íƒëœ ì•ŒíŒŒë²³ ìŠ¤ì™€ì¹˜ */
        #selected-participant-swatch {
            width: 60px;
            height: 60px;
            margin: 0.75rem auto 0;
            border-radius: 50%;
            border: 5px solid hsl(25, 45%, 40%);
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
            text-align: center;
            line-height: 50px;
            font-size: 2rem;
            font-weight: bold;
            color: hsl(25, 35%, 15%);
            background-color: #E9E9E9;
        }

        /* --- ì¥ë°”êµ¬ë‹ˆ ìš”ì•½ ì˜ì—­ ìŠ¤íƒ€ì¼ --- */
        #cart-summary {
            padding: 1.5rem;
            background-color: hsl(30, 20%, 98%);
            border-radius: 1rem;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            border: 1px solid hsl(35, 60%, 70%);
        }

        #cart-summary h2 {
            font-size: 1.5rem;
            color: hsl(25, 45%, 40%);
            margin-bottom: 1rem;
            border-bottom: 2px solid hsl(35, 60%, 70%);
            padding-bottom: 0.5rem;
        }

        /* ì¥ë°”êµ¬ë‹ˆ ì •ë³´ ê·¸ë£¹ */
        .cart-info {
            margin-bottom: 0.75rem; 
        }

        /* ì´ ê°œìˆ˜ì™€ ê¸ˆì•¡ ì •ë³´ê°€ ë‹´ê¸´ ê° <p> íƒœê·¸ (ê°ê° í•œ ì¤„) */
        .cart-info p {
            font-size: 1.125rem;
            margin-bottom: 0.75rem;
            display: flex; 
            justify-content: space-between; 
            white-space: nowrap; 
        }
        
        /* ì˜ˆìƒ ê²°ì œ ê¸ˆì•¡ í•­ëª© ìŠ¤íƒ€ì¼ */
        .cart-info .total {
            font-weight: bold;
            font-size: 1.25rem;
            color: hsl(25, 45%, 40%);
            padding-top: 0.5rem;
            border-top: 1px dashed hsl(25, 15%, 45%, 0.5);
            margin-bottom: 0;
        }
        
        /* ì¥ë°”êµ¬ë‹ˆ ìƒì„¸ ëª©ë¡ ìŠ¤íƒ€ì¼ */
        #cart-details {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid hsl(30, 20%, 85%);
        }
        
        .cart-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.95rem;
            margin-bottom: 0.5rem;
            padding: 0.5rem;
            background-color: hsl(35, 25%, 96%);
            border-radius: 0.5rem;
            white-space: nowrap; 
            overflow: hidden; 
        }
        
        .cart-item-name {
            font-weight: 500;
            flex-grow: 1;
            min-width: 50px; 
            overflow: hidden; 
            text-overflow: ellipsis;
        }
        
        .cart-item-qty {
            font-weight: bold;
            color: hsl(25, 45%, 40%);
            margin-left: 0.5rem;
            flex-shrink: 0;
        }

        @media (max-width: 1024px) {
            .main-wrapper {
                flex-direction: column;
                margin: 2rem auto;
            }

            .container {
                padding-right: 0;
                margin-bottom: 2rem;
            }

            #sidebar {
                position: static;
                width: 100%;
                top: 2rem; /* í—¤ë”ê°€ ì¤„ì–´ë“¤ì—ˆì„ ë•Œ ì‚¬ì´ë“œë°” ê³ ì • ìœ„ì¹˜ ì¡°ì • */
            }
            header h1 {
                font-size: 2.5rem;
            }
            header p {
                font-size: 1rem;
            }
        }
        
        /* ë©”ë‰´ ë ˆì´ì•„ì›ƒ */
        .menu-row {
            display: grid;
            grid-template-columns: 1fr; 
            gap: 1.5rem;
            margin-bottom: 3rem; 
            align-items: start; 
        }

        @media (min-width: 768px) {
            .menu-row {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        .category-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: hsl(25, 45%, 40%);
            border-bottom: 2px solid hsl(35, 60%, 70%);
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
        }
        
        .menu-item {
            background-color: hsl(30, 20%, 98%);
            padding: 0.75rem 1rem;
            margin-bottom: 0.5rem;
            border-radius: 0.5rem;
            display: flex;
            justify-content: space-between; 
            align-items: center;
        }
        
        /* ë©”ë‰´ ì •ë³´ ë° í…œí”„/ë§› ì„ íƒ ì˜ì—­ (ì™¼ìª½ ê·¸ë£¹) */
        .menu-info-group {
            display: flex; 
            flex-direction: column; 
            align-items: flex-start; 
            flex-grow: 1; 
            margin-right: 0.5rem; 
            white-space: nowrap; 
            overflow: hidden; 
        }

        /* ë©”ë‰´ ì´ë¦„, ì˜µì…˜, ê°€ê²©ì„ ë¬¶ëŠ” ê·¸ë£¹ */
        .menu-details-line {
            display: flex; 
            align-items: center; /* ì„¸ë¡œ ì •ë ¬ */
            width: 100%; 
            margin-top: 0.5rem; 
            overflow: hidden;
            white-space: nowrap; 
        }

        /* ë©”ë‰´ ì´ë¦„ (ê°€ë³€ì ìœ¼ë¡œ ê³µê°„ ì‚¬ìš©) */
        .menu-item-name {
            font-weight: 500;
            color: hsl(25, 35%, 15%);
            flex-shrink: 1; 
            cursor: pointer;
            text-overflow: ellipsis; 
            overflow: hidden;
            white-space: nowrap; 
            min-width: 50px; 
            margin-left: 0.5rem; /* ì˜µì…˜ ë²„íŠ¼ê³¼ì˜ ê°„ê²© */
            margin-right: 0.5rem;
        }
        
        .menu-item-price {
            color: hsl(25, 15%, 45%);
            font-weight: 600;
            margin-left: auto; /* ê°€ê²©ì„ ì˜¤ë¥¸ìª½ ëìœ¼ë¡œ ë°€ì–´ëƒ…ë‹ˆë‹¤. */
            white-space: nowrap;
            flex-shrink: 0; 
        }
        
        /* --- í…œí”„/ë§› ì„ íƒ ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ê³µí†µ) --- */
        .temp-selection, .flavor-selection {
            display: flex; /* ë²„íŠ¼ì„ í•œ ì¤„ë¡œ ì •ë ¬ */
            font-size: 0.8rem;
            border: 1px solid hsl(35, 60%, 70%);
            border-radius: 5px;
            overflow: hidden;
            flex-shrink: 0; 
            margin-bottom: 0; /* ë§ˆì§„ ì œê±° */
        }
        
        .temp-selection label, .flavor-selection label {
            padding: 0.3rem 0.5rem;
            cursor: pointer;
            background-color: hsl(30, 20%, 98%);
            color: hsl(25, 35%, 15%);
            transition: all 0.2s; /* ë¶€ë“œëŸ¬ìš´ ì „í™˜ íš¨ê³¼ */
            white-space: nowrap;
            display: inline-block; /* í•œ ì¤„ ì •ë ¬ì„ ìœ„í•œ ì„¤ì • */
        }

        .temp-selection input[type="radio"], .flavor-selection input[type="radio"] {
            display: none;
        }
        
        .temp-selection input[type="radio"]:checked + label,
        .flavor-selection input[type="radio"]:checked + label {
            background-color: hsl(25, 45%, 40%);
            color: white;
            font-weight: bold;
            box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.2); /* ì„ íƒ ì‹œ ê·¸ë¦¼ì ê°•ì¡° */
        }

        .temp-selection label:not(:last-child),
        .flavor-selection label:not(:last-child) { 
             border-right: 1px solid hsl(35, 60%, 70%); 
        }
        /* --- /í…œí”„/ë§› ì„ íƒ ë²„íŠ¼ ìŠ¤íƒ€ì¼ --- */

        /* --- ìˆ˜ëŸ‰ ì¡°ì ˆ ë²„íŠ¼ ìŠ¤íƒ€ì¼ (ê°€ì¥ ì˜¤ë¥¸ìª½) --- */
        .quantity-controls {
            display: flex;
            align-items: center;
            background-color: hsl(35, 60%, 70%, 0.3);
            border-radius: 0.5rem;
            margin-left: auto; 
            flex-shrink: 0; 
        }
        
        .quantity-controls button {
            background-color: hsl(25, 45%, 40%);
            color: white;
            border: none;
            width: 30px;
            height: 30px;
            font-size: 1.2rem;
            cursor: pointer;
            transition: background-color 0.2s;
            line-height: 1;
            padding: 0;
            border-radius: 0.5rem;
        }

        .quantity-controls button:hover {
            background-color: hsl(25, 60%, 50%);
        }

        .quantity-controls .quantity {
            width: 30px;
            text-align: center;
            font-weight: bold;
            color: hsl(25, 35%, 15%);
            padding: 0 5px;
        }
        /* --- /ìˆ˜ëŸ‰ ì¡°ì ˆ ë²„íŠ¼ ìŠ¤íƒ€ì¼ --- */
        
        /* ì´ë¯¸ì§€ ë””ìŠ¤í”Œë ˆì´ ìŠ¤íƒ€ì¼ */
        .image-display { background-color: hsl(30, 20%, 98%); border-radius: 1rem; box-shadow: 0 10px 15px rgba(0, 0, 0, 0.1); padding: 1.5rem; margin-top: 1rem; margin-bottom: 1rem; display: none; flex-direction: column; align-items: center; justify-content: center; animation: fadeIn 0.3s ease; position: relative; }
        .image-display.show { display: flex; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(-10px); } to { opacity: 1; transform: translateY(0); } }
        .image-display h3 { font-size: 1.5rem; font-weight: bold; color: hsl(25, 45%, 40%); margin-bottom: 1rem; text-align: center; }
        .image-display-price { font-size: 1.25rem; color: hsl(35, 60%, 70%); font-weight: 600; margin-bottom: 1.5rem; }
        .image-container { width: 100%; aspect-ratio: 1; background-color: hsl(30, 25%, 90%); border-radius: 0.75rem; overflow: hidden; display: flex; align-items: center; justify-content: center; }
        .image-container img { width: 100%; height: 100%; object-fit: cover; }
        .placeholder-text { text-align: center; color: hsl(25, 15%, 45%); padding: 2rem; }
        .close-button { position: absolute; top: 10px; right: 10px; background-color: hsl(25, 45%, 40%); color: white; border: none; border-radius: 50%; width: 30px; height: 30px; font-size: 1.2rem; cursor: pointer; display: flex; align-items: center; justify-content: center; line-height: 1; padding-bottom: 2px; box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2); transition: background-color 0.2s ease; z-index: 10; }
        .close-button:hover { background-color: hsl(25, 60%, 50%); }

        footer {
            background-color: hsl(30, 20%, 98%);
            border-top: 1px solid hsl(30, 20%, 85%);
            padding: 1.5rem 1rem;
            margin-top: auto;
            text-align: center;
            color: hsl(25, 15%, 45%);
            box-shadow: 0 -2px 8px rgba(0,0,0,0.05); /* í‘¸í„° ê·¸ë¦¼ì ì¶”ê°€ */
        }

        @media (max-width: 768px) {
            header {
                padding: 1.5rem 1rem;
            }
            header h1 {
                font-size: 2rem;
            }
            header p {
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>ì˜¤ì„¸ìš”ìˆ˜ì œë””ì €íŠ¸ ì¹´í˜</h1>
        <p>COFFEE & DESSERT</p>
    </header>

    <div class="main-wrapper">
        <div class="container">
            <div id="menu-container"></div> 
        </div>

        <aside id="sidebar">
            <section id="calculator-section">
                <h2>ì˜¤ëŠ˜ì˜ ê³„ì‚°ì™• ğŸ‘‘</h2>
                
                <div class="input-group">
                    <label for="participant-count">ì°¸ì—¬ ì¸ì› ìˆ˜ (ìµœëŒ€ 26ëª…)</label>
                    <input type="number" id="participant-count" min="2" max="26" value="4">
                </div>
                
                <button class="confirm-button present" id="present-button" onclick="presentParticipants()">ì¸ì› ìˆ˜ í™•ì • ë° ì•ŒíŒŒë²³ ì œì‹œ</button>
                <button class="confirm-button" id="pick-button" onclick="pickWinnerParticipant()" style="display: none;">ê³„ì‚°ì™• ë½‘ê¸°!</button>
                
                <div id="participant-display-area">
                    <p>ì œì‹œëœ ì•ŒíŒŒë²³:</p>
                    <div class="participant-palette" id="participant-palette">
                        </div>
                    <p>ë½‘íŒ ê³„ì‚°ì™•:</p>
                    <div class="participant-swatch" id="selected-participant-swatch">
                        ?
                    </div>
                </div>
            </section>
            <section id="cart-summary">
                <h2>ğŸ›’ ì¥ë°”êµ¬ë‹ˆ ìš”ì•½</h2>
                <div class="cart-info">
                    <p>ì´ ë©”ë‰´ ê°œìˆ˜: <span id="total-items">0ê°œ</span></p>
                    <p class="total">ì˜ˆìƒ ê²°ì œ ê¸ˆì•¡: <span id="total-price">0ì›</span></p>
                </div>
                <div id="cart-details">
                </div>
            </section>
            </aside>
    </div>

    <footer>
        <p>Â© 2025 ì˜¤ì„¸ìš”ìˆ˜ì œë””ì €íŠ¸ ì¹´í˜. All rights reserved.</p>
    </footer>

    <script>
        // ì „ì—­ ë³€ìˆ˜ë¡œ í˜„ì¬ ì œì‹œëœ ì•ŒíŒŒë²³ ëª©ë¡ì„ ì €ì¥
        window.currentParticipants = [];

        // --- ë©”ë‰´ ë°ì´í„° ë° ì¥ë°”êµ¬ë‹ˆ ë¡œì§ ---
        
        function parsePrice(price) {
            if (typeof price === 'number') return price;
            if (typeof price === 'object') return price.hot; 
            const cleanedPrice = String(price).split('/')[0].replace(/[^0-9]/g, '');
            return parseInt(cleanedPrice) || 0;
        }

        const menuData = {
            "ì˜¤ì„¸ìš” ì‹œê·¸ë‹ˆì²˜": [
                { id: 1, name: "ëª¬ë“œë¼ë–¼(only ice)", price: 5500, tempOption: 'ice', image: "https://via.placeholder.com/400x400/FFDDC1/8B4513?text=Ond+Latte" },
                { id: 2, name: "ë¼ë²¤ë”ë¼ë–¼(only ice)", price: 5500, tempOption: 'ice', image: "https://via.placeholder.com/400x400/FFDDCC/8B4513?text=Omil+Diole" },
                { id: 3, name: "ì˜¤ë Œì§€ì…”ë²—ì—ì´ë“œ(only ice)", price: 5500, tempOption: 'ice', image: "images/ì˜¤ë Œì§€ì…”ë²—ìŠ¤íŒŒí´ë§.jpg" },
                { id: 4, name: "ëƒ‰ìœ¨ë¬´(only ice)", price: 4500, tempOption: 'ice', image: "images/ëƒ‰ìœ¨ë¬´.jpg" }
            ], 
            "í”„ë¼í˜": [
                { id: 5, name: "ì—ìŠ¤í”„ë ˆì†Œ ë©”ê°€í†¤", price: 5000, tempOption: 'none', image: "https://via.placeholder.com/400x400/D2B48C/8B4513?text=Espresso+Macaron" },
                { id: 6, name: "ë”ë¸”ìë°”ì¹©", price: 5000, tempOption: 'none', image: "https://via.placeholder.com/400x400/FFE4B5/8B4513?text=Double+Chivanil" },
                { id: 7, name: "ì˜¤ë ˆì˜¤ë ˆì˜¤", price: 5000, tempOption: 'none', image: "https://via.placeholder.com/400x400/2F4F4F/FFFFFF?text=Oreo" },
                { id: 8, name: "ìˆœìˆ˜ë°€í¬", price: 5000, tempOption: 'none', image: "https://via.placeholder.com/400x400/F8F8FF/8B4513?text=Pure+Milk" }
            ], 
            "ë°€í¬ë“œë§í¬": [
                { id: 9, name: "í“¨ì–´ ê·¸ë¦°í‹° ë¼ë–¼(hot/ice)", price: 4000, tempOption: 'optional', image: "images/í“¨ì–´ê·¸ë¦°í‹°ë¼ë–¼.jpg" },
                { id: 10, name: "ë¡œì–„ ë°€í¬í‹°", price: 4000, tempOption: 'none', image: "https://via.placeholder.com/400x400/B0E0E6/8B4513?text=Konjac+Aloe" },
                { id: 11, name: "ë°€í¬ ì´ˆì½œë¦¿", price: 4000, tempOption: 'optional', image: "https://via.placeholder.com/400x400/8B4513/FFFFFF?text=Milk+Chocolate" },
                { id: 12, name: "ê³ êµ¬ë§ˆ ë¼ë–¼", price: 4500, tempOption: 'optional', image: "https://via.placeholder.com/400x400/FFDAB9/8B4513?text=Sweet+Potato+Latte" },
                { id: 13, name: "ì˜¤íŠ¸ë°€ ë¼ë–¼", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/FFA500/FFFFFF?text=Orange+Latte" }
            ], 
            "ìˆ˜ì œ ë² ì´ì»¤ë¦¬": [
                { id: 14, name: "ì‹œì˜¤ë¹µ(ì†Œê¸ˆë¹µ)", price: 3000, tempOption: 'none', image: "images/ì†Œê¸ˆë¹µ.jpg" },
                { id: 15, name: "ë¨¹ë¬¼ì†Œê¸ˆë¹µ", price: 4000, tempOption: 'none', image: "images/ë¨¹ë¬¼ì†Œê¸ˆë¹µ" },
                { id: 16, name: "ì°ë°¤ì‹ë¹µ", price: 8000, tempOption: 'none', image: "images/ì°ë°¤ì‹ë¹µ.jpg" },
                { id: 17, name: "ë°€í¬ë¸Œë ˆë“œ-ë²„í„°ëª¨ë‹˜ë¹µ", price: 6000, tempOption: 'none', image: "images/ë°€í¬ë¸Œë ˆë“œ.jpg" },
                { id: 18, name: "ì°¹ìŒ€ë–¡ ì†Œê¸ˆë¹µ", price: 4000, tempOption: 'none', image: "https://via.placeholder.com/400x400/FFFAF0/8B4513?text=Rice+Cake+Shio+Bread" }
            ], 
            "íœ˜ë‚­ì‹œì—": [
                { id: 19, name: "í”Œë ˆì¸ íœ˜ë‚­ì‹œì—", price: 1500, tempOption: 'none', image: "https://via.placeholder.com/400x400/F5DEB3/8B4513?text=Plain+Financier" },
                { id: 20, name: "ëˆ„ë£½ì§€ íœ˜ë‚­ì‹œì—", price: 2500, tempOption: 'none', image: "images/ëˆ„ë£½ì§€íœ˜ë‚­ì‹œì—.jpg" },
                { id: 21, name: "ê³ ë¥´ê³¤ì¡¸ë¼ íœ˜ë‚­ì‹œì—", price: 1500, tempOption: 'none', image: "https://via.placeholder.com/400x400/E0FFFF/8B4513?text=Gorgonzola+Financier" },
                { id: 22, name: "ë¬´í™”ê³¼ íœ˜ë‚­ì‹œì—", price: 2500, tempOption: 'none', image: "https://via.placeholder.com/400x400/FDD017/8B4513?text=Fig+Financier" },
                { id: 23, name: "ì´ˆì½” ì¹´ë¼ë©œ íœ˜ë‚­ì‹œì—", price: 2500, tempOption: 'none', image: "https://via.placeholder.com/400x400/A0522D/FFFFFF?text=Choco+Caramel+Financier" },
                { id: 24, name: "ë‘ë°”ì´ ì´ˆì½” íœ˜ë‚­ì‹œì—", price: 5500, tempOption: 'none', image: "https://via.placeholder.com/400x400/4F2C0A/FFFFFF?text=Dubai+Choco+Financier" }
            ], 
            "êµ¬ì›€ê³¼ì": [
                { id: 25, name: "í‘ì„ìì°°ë–¡ ì¿ í‚¤", price: 2500, tempOption: 'none', image: "https://via.placeholder.com/400x400/2F4F4F/FFFFFF?text=Black+Sesame+Cookie" },
                { id: 26, name: "ì—ê·¸íƒ€ë¥´íŠ¸", price: 3000, tempOption: 'none', image: "images/ì—ê·¸íƒ€ë¥´íŠ¸.jpg" },
                { id: 27, name: "ì»¤í”¼í”¼ì¹¸ë§ˆë“¤ë Œ", price: 2500, tempOption: 'none', image: "images/ì»¤í”¼í”¼ì¹¸ë§ˆë“¤ë Œ.jpg" },
                { id: 28, name: "í”¼ì¹¸íŒŒì´", price: 2500, tempOption: 'none', image: "https://via.placeholder.com/400x400/CD853F/FFFFFF?text=Pecan+Pie" },
                { id: 29, name: "í”„ë ˆì²¼ìŠ¤ì½˜", price: 2500, tempOption: 'none', image: "https://via.placeholder.com/400x400/F5DEB3/8B4513?text=Pretzel+Scone" },
                { id: 30, name: "í‘ì„ìë§ˆë“¤ë Œ", price: 2500, tempOption: 'none', image: "https://via.placeholder.com/400x400/2F4F4F/FFFFFF?text=Black+Sesame+Madeleine" }
            ], 
            "ì»¤í”¼": [
                { id: 31, name: "ì—ìŠ¤í”„ë ˆì†Œ", price: 2800, tempOption: 'optional', image: "https://via.placeholder.com/400x400/6F4E37/FFFFFF?text=Espresso" },
                { id: 32, name: "ì•„ë©”ë¦¬ì¹´ë…¸(hot/ice)", price: 2800, tempOption: 'optional', image: "images/ì•„ë©”ë¦¬ì¹´ë…¸.jpg" },
                { id: 33, name: "ì¹´í˜ ë¼ë–¼", price: { hot: 4000, ice: 4300 }, tempOption: 'optional', image: "images/ì¹´í˜ë¼ë–¼.jpg" },
                { id: 34, name: "ë°”ë‹ë¼ ë¼ë–¼", price: { hot: 4000, ice: 4300 }, tempOption: 'optional', image: "images/ë°”ë‹ë¼ë¼ë–¼.jpg" },
                { id: 35, name: "ì¹´í˜ëª¨ì¹´", price: { hot: 4000, ice: 4300 }, tempOption: 'optional', image: "https://via.placeholder.com/400x400/8B4513/FFFFFF?text=Cafe+Mocha" },
                { id: 36, name: "ì¹´ë¼ë©œ ë§ˆë¼ì•„ë˜", price: { hot: 4000, ice: 4300 }, tempOption: 'optional', image: "https://via.placeholder.com/400x400/D2B48C/8B4513?text=Caramel+Macchiato" },
                { id: 37, name: "í”Œë«í™”ì´íŠ¸(hot/ice)", price: 4000, tempOption: 'optional', image: "https://via.placeholder.com/400x400/DCDCDC/8B4513?text=Flat+White" },
                { id: 38, name: "í¬ë¦¼ ì•„ì´ë¦¬ì¹´ë…¸(hot/ice)", price: 4800, tempOption: 'optional', image: "https://via.placeholder.com/400x400/F5F5DC/8B4513?text=Cream+Americano" }
            ], 
            "ì¡°ê°ì¼€ì´í¬": [
                { id: 39, name: "(í˜„ - ê³¨ë“œí‚¤ìœ„)ê³¼ì¼ìš°ìœ  ìƒí¬ë¦¼ ì¼€ì´í¬", price: 6000, tempOption: 'none', image: "images/ê³¼ì¼ìš°ìœ  ìƒí¬ë¦¼ ì¼€ì´í¬.jpg" },
                { id: 40, name: "ì˜¤ë ˆì˜¤ ì´ˆì½” ì¼€ì´í¬", price: 6000, tempOption: 'none', image: "https://via.placeholder.com/400x400/2F4F4F/FFFFFF?text=Oreo+Chocolate+Cake" },
                { id: 41, name: "ê³¨ë“œêµ¬ë§ˆ ì¼€ì´í¬", price: 6000, tempOption: 'none', image: "https://via.placeholder.com/400x400/FFDAB9/8B4513?text=Gold+Sweet+Potato+Cake" },
                { id: 42, name: "ë”ë¸”ì¹˜ì¦ˆ ì¼€ì´í¬", price: 6000, tempOption: 'none', image: "https://via.placeholder.com/400x400/FDF5E6/8B4513?text=Double+Cheese+Cake" },
                { id: 43, name: "ë°”ìŠ¤í¬ì¹˜ì¦ˆ ì¼€ì´í¬", price: 6000, tempOption: 'none', image: "images/ë°”ìŠ¤í¬ì¹˜ì¦ˆì¼€ì´í¬.jpg" },
                { id: 44, name: "í‹°ë¼ë¯¸ìˆ˜ í•œëª¨ì˜¤ë¦¬ì§€ë„ ì¼€ì´í¬", price: 8500, tempOption: 'none', image: "images/í‹°ë¼ë¯¸ìˆ˜ í•œëª¨ì˜¤ë¦¬ì§€ë„ ì¼€ì´í¬.jpg" },
                { id: 45, name: "ë¸Œë¼ìš°ë‹ˆ ì¼€ì´í¬", price: 6000, tempOption: 'none', image: "https://via.placeholder.com/400x400/8B4513/FFFFFF?text=Brownie+Cake" }
            ], 
            "ìŠ¤íŒŒí´ë§": [
                { id: 46, name: "ë¦¬ì–¼ìë‘", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/BFFF00/8B4513?text=Lime+Sour" },
                { id: 47, name: "ë¦¬ì–¼í”¼ì¹˜", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/FFDAB9/8B4513?text=Lime+Peach" },
                { id: 48, name: "ë¦¬ì–¼ë§ê³ ", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/FFBF00/8B4513?text=Lime+Mango" },
                { id: 49, name: "ë¦¬ì–¼ë ˆëª¬", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/FFFF99/8B4513?text=Lime+Lemon" },
                { id: 50, name: "ë¦¬ì–¼ìƒ¤ì¸ë¨¸ìŠ¤ì»·", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/ADFF2F/8B4513?text=Lime+Muscat" },
                { id: 51, name: "ë¦¬ì–¼ì²­ìëª½", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/7CFC00/8B4513?text=Lime+Green+Apple" },
                { id: 52, name: "ìëª½ìëª½", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/FF8C69/FFFFFF?text=Grapefruit" },
                { id: 53, name: "íˆë¹„ìŠ¤ì»¤ìŠ¤ë¼ì„", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/FFD700/8B4513?text=Honey+Scandal" },
                { id: 54, name: "ë¦¬ì–¼ìˆ˜ì œìëª½", price: 6000, tempOption: 'none', image: "https://via.placeholder.com/400x400/B0E0E6/8B4513?text=Lime+Supesham" }
            ], 
            "ìŠ¤ë¬´ë””": [
                { id: 55, name: "ìš”ê±°íŠ¸ ìŠ¤ë¬´ë””", price: 5000, tempOption: 'flavor', flavors: ['ë”¸ê¸°', 'ë§ê³ ', 'ë¦¬ì–¼ í”¼ì¹˜', 'ë¸”ë£¨ë² ë¦¬'], image: "https://via.placeholder.com/400x400/F0FFF0/8B4513?text=Yogurt+Smoothie" },
                { id: 56, name: "ë¦¬ì–¼ ìë‘ ìŠ¤ë¬´ë””", price: 5000, tempOption: 'none', image: "https://via.placeholder.com/400x400/DAA3A3/FFFFFF?text=Plum+Smoothie" },
                { id: 57, name: "ë¦¬ì–¼ ì²­ìëª½ ìŠ¤ë¬´ë””", price: 5000, tempOption: 'none', image: "https://via.placeholder.com/400x400/98FB98/FFFFFF?text=Green+Apple+Smoothie" }
            ], 
            "ëƒ‰ì¥ ë””ì €íŠ¸": [
                { id: 58, name: "ë°”ë‹ë¼ í‘¸ë”©", price: 6000, tempOption: 'none', image: "images/ë°”ë‹ë¼í‘¸ë”©.jpg" },
                { id: 59, name: "ë¸”ë¡ ë””", price: 2500, tempOption: 'none', image: "images/ë¸”ë¡ ë””.jpg" },
                { id: 60, name: "ì«€ë“ë²„í„°ë°”", price: 2500, tempOption: 'none', image: "images/ì«€ë“ë²„í„°ë°”.jpg" }
            ], 
            "ë²„ë¸”í‹°": [
                { id: 61, name: "í‘ë‹¹ ë²„ë¸”í‹°", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/654321/FFFFFF?text=Brown+Sugar+Bubble+Tea" },
                { id: 62, name: "ì¹´í˜ í‘ë‹¹ ë²„ë¸”í‹°", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/4A2C0A/FFFFFF?text=Coffee+Brown+Sugar+Bubble+Tea" },
                { id: 63, name: "ë¼ì§€ë°” ë²„ë¸”í‹°", price: 4500, tempOption: 'none', image: "https://via.placeholder.com/400x400/B0C4DE/8B4513?text=Dessert+Bubble+Tea" }
            ], 
            "í‹°": [
                { id: 64, name: "ë¦¬ì–¼ ìë‘(hot/ice)", price: { hot: 4500, ice: 5000 }, tempOption: 'optional', image: "https://via.placeholder.com/400x400/DAA3A3/FFFFFF?text=Real+Plum+Tea" },
                { id: 65, name: "ë¦¬ì–¼ ì²­ì‚¬ê³¼ ìˆ˜ì œ(hot/ice)", price: { hot: 5500, ice: 6000 }, tempOption: 'optional', image: "https://via.placeholder.com/400x400/98FB98/FFFFFF?text=Real+Green+Apple+Tea" }
            ], 
            "í‚¤ì¦ˆ": [
                { id: 66, name: "í”¼ì¹˜ìš”ê±°íŠ¸ ìŠ¤ë¬´ë””", price: 3000, tempOption: 'none', image: "https://via.placeholder.com/400x400/FFDAB9/8B4513?text=Peach+Yogurt" },
                { id: 67, name: "ë°€í¬ ì´ˆì½œë¦¿", price: 3000, tempOption: 'optional', image: "https://via.placeholder.com/400x400/8B4513/FFFFFF?text=Kids+Milk+Chocolate" }
            ], 
            "ì‹œì¦Œë©”ë‰´": [
                { id: 68, name: "ìˆ˜ì œìƒê°•ë¼ë–¼(only hot)", price: 5000, tempOption: 'hot', image: "https://via.placeholder.com/400x400/E6BC5A/8B4513?text=Ginger+Latte" },
                { id: 69, name: "ê³¼ì¼ì¥¬ìŠ¤(ì œì² ê³¼ì¼)", price: 5000, tempOption: 'none', image: "https://via.placeholder.com/400x400/B0E0E6/8B4513?text=Fruit+Juice" }
            ],
            "ìˆ˜ì œë§ˆì¹´ë¡±": [
                { id: 70, name: "ë§ˆì¹´ë¡±", price: 1500, tempOption: 'none', image: "images/ë§ˆì¹´ë¡±.jpg" }
            ] 
        };
        
        const cart = {};
        let selectedItem = null;
        let currentImageDisplay = null;
        
        const menuGroups = [
            ["ì˜¤ì„¸ìš” ì‹œê·¸ë‹ˆì²˜", "í”„ë¼í˜", "ë°€í¬ë“œë§í¬"], 
            ["ìˆ˜ì œ ë² ì´ì»¤ë¦¬", "íœ˜ë‚­ì‹œì—", "êµ¬ì›€ê³¼ì"], 
            ["ì»¤í”¼", "ì¡°ê°ì¼€ì´í¬", "ìŠ¤íŒŒí´ë§"], 
            ["ìŠ¤ë¬´ë””", "ëƒ‰ì¥ ë””ì €íŠ¸", "ë²„ë¸”í‹°"], 
            ["í‹°", "í‚¤ì¦ˆ", "ì‹œì¦Œë©”ë‰´"],
            ["ìˆ˜ì œë§ˆì¹´ë¡±"] 
        ];


        function findItemById(itemId) {
            for (const category in menuData) {
                const item = menuData[category].find(i => i.id === itemId);
                if (item) return item;
            }
            return null;
        }

        function getPriceText(price, option) {
            let actualPrice = 0;
            if (typeof price === 'object') {
                actualPrice = price[option] || price.hot;
            } else {
                actualPrice = price;
            }
            return `${actualPrice.toLocaleString()}ì›`;
        }

        function getSelectedOption(itemId, menuItemElement) {
            const optionInputs = menuItemElement.querySelectorAll(`input[name="option-${itemId}"]:checked`);
            if (optionInputs.length > 0) {
                return optionInputs[0].value;
            }
            const hiddenInput = menuItemElement.querySelector(`input[name="option-${itemId}"][type="hidden"]`);
            if (hiddenInput) return hiddenInput.value;
            
            return 'none';
        }

        function getItemActualPrice(item, option) {
            if (typeof item.price === 'object') {
                return item.price[option] || item.price.hot; 
            }
            return item.price;
        }

        function updateItemPriceDisplay(itemId, newOption, menuItemElement) {
            const item = findItemById(itemId);
            if (!item) return;

            const priceDisplay = menuItemElement.querySelector(`#price-display-${itemId}`);
            if (priceDisplay) {
                priceDisplay.textContent = getPriceText(item.price, newOption);
            }
            
            const oldQtyEl = menuItemElement.querySelector('.quantity');
            const cleanNewOption = newOption.replace(/\s/g, '');
            const cartKey = `${itemId}-${cleanNewOption}`; 

            const newQty = cart[cartKey] ? cart[cartKey].quantity : 0;
            oldQtyEl.id = `qty-${cartKey}`;
            oldQtyEl.textContent = newQty;
        }

        function updateQuantityDisplay(cartKey, quantity) {
            const qtyElement = document.getElementById(`qty-${cartKey}`);
            if (qtyElement) {
                qtyElement.textContent = quantity;
            }
        }

        function incrementQuantity(event, itemId, menuItemElement) {
            event.stopPropagation();
            
            const option = getSelectedOption(itemId, menuItemElement);
            const cleanOption = option.replace(/\s/g, ''); 
            const cartKey = `${itemId}-${cleanOption}`;
            const item = findItemById(itemId);
            if (!item) return;

            if (cart[cartKey]) {
                cart[cartKey].quantity++;
            } else {
                const price = getItemActualPrice(item, option);
                cart[cartKey] = { item: item, quantity: 1, option: option, price: price };
            }

            updateQuantityDisplay(cartKey, cart[cartKey].quantity);
            updateCartSummary();
        }

        function decrementQuantity(event, itemId, menuItemElement) {
            event.stopPropagation();
            
            const option = getSelectedOption(itemId, menuItemElement);
            const cleanOption = option.replace(/\s/g, ''); 
            const cartKey = `${itemId}-${cleanOption}`;
            
            if (cart[cartKey]) {
                cart[cartKey].quantity--;
                
                if (cart[cartKey].quantity <= 0) {
                    delete cart[cartKey];
                }
            }

            const quantity = cart[cartKey] ? cart[cartKey].quantity : 0;
            updateQuantityDisplay(cartKey, quantity);
            updateCartSummary();
        }

        function updateCartSummary() {
            let totalItems = 0;
            let totalPrice = 0;
            const cartDetails = document.getElementById('cart-details');
            cartDetails.innerHTML = ''; 

            const cartKeys = Object.keys(cart).sort((a, b) => {
                const itemIdA = parseInt(a.split('-')[0]);
                const itemIdB = parseInt(b.split('-')[0]);
                return itemIdA - itemIdB;
            }
            );

            cartKeys.forEach(cartKey => {
                const cartItem = cart[cartKey];
                if (cartItem.quantity > 0) {
                    totalItems += cartItem.quantity;
                    totalPrice += cartItem.price * cartItem.quantity;

                    const detailDiv = document.createElement('div');
                    detailDiv.className = 'cart-item';
                    
                    let optionSuffix = '';
                    
                    if (cartItem.item.tempOption === 'optional') {
                        optionSuffix = (cartItem.option === 'hot' ? ' (HOT)' : ' (ICE)');
                    } else if (cartItem.item.tempOption === 'flavor') {
                        optionSuffix = ` (${cartItem.option})`;
                    } else if (cartItem.item.tempOption === 'hot' || cartItem.item.tempOption === 'ice') {
                        optionSuffix = ''; 
                    } else {
                        optionSuffix = '';
                    }

                    detailDiv.innerHTML = `
                        <span class="cart-item-name">${cartItem.item.name}${optionSuffix}</span>
                        <span class="cart-item-qty">${cartItem.quantity}ê°œ / ${(cartItem.price * cartItem.quantity).toLocaleString()}ì›</span>
                    `;
                    cartDetails.appendChild(detailDiv);
                }
            });

            document.getElementById('total-items').textContent = `${totalItems}ê°œ`;
            document.getElementById('total-price').textContent = `${totalPrice.toLocaleString()}ì›`;
        }
        
        function selectItem(menuData, itemId, element) {
             const item = findItemById(itemId);
             if (!item) return;
             
            if (element.classList.contains('selected') && currentImageDisplay && currentImageDisplay.previousSibling === element) {
                closeImageDisplay();
                return;
            }
            
            document.querySelectorAll('.menu-item').forEach(el => {
                el.classList.remove('selected');
            });

            if (currentImageDisplay) {
                currentImageDisplay.remove();
                currentImageDisplay = null;
            }

            element.classList.add('selected');
            selectedItem = item;

            const imageDisplay = document.createElement('div');
            imageDisplay.className = 'image-display show';
            
            let imageContent;
            const closeButtonHtml = `<button class="close-button" onclick="closeImageDisplay(event)">&times;</button>`;
            
            const currentOption = getSelectedOption(itemId, element);
            const displayPrice = getPriceText(item.price, currentOption);


            if (item.image) {
                imageContent = `
                    ${closeButtonHtml}
                    <h3>${item.name}</h3>
                    <p class="image-display-price">${displayPrice}</p>
                    <div class="image-container">
                        <img src="${item.image}" alt="${item.name}">
                    </div>
                `;
            } else {
                imageContent = `
                    ${closeButtonHtml}
                    <h3>${item.name}</h3>
                    <p class="image-display-price">${displayPrice}</p>
                    <div class="image-container">
                        <div class="placeholder-text">
                            <p>ì´ë¯¸ì§€ë¥¼ ì¶”ê°€í•´ì£¼ì„¸ìš”</p>
                            <p>menuDataì— image ì†ì„±ì„ ì¶”ê°€í•˜ì„¸ìš”</p>
                        </div>
                    </div>
                `;
            }
            imageDisplay.innerHTML = imageContent;

            const parentSection = element.parentElement;
            parentSection.insertBefore(imageDisplay, element.nextSibling);

            currentImageDisplay = imageDisplay;
        }

        function closeImageDisplay(event) {
            if (event) {
                event.stopPropagation();
            }
            if (currentImageDisplay) {
                currentImageDisplay.remove();
                currentImageDisplay = null;
            }
            document.querySelectorAll('.menu-item').forEach(el => {
                el.classList.remove('selected');
            });
            selectedItem = null;
        }

        function renderMenu() {
            const menuContainer = document.getElementById('menu-container');
            menuContainer.innerHTML = '';

            menuGroups.forEach(group => {
                const rowDiv = document.createElement('div');
                rowDiv.className = 'menu-row';
                
                group.forEach(category => {
                    if (menuData[category]) {
                        const section = document.createElement('div');
                        section.className = 'menu-section';

                        const title = document.createElement('h2');
                        title.className = 'category-title';
                        title.textContent = category;
                        section.appendChild(title);

                        menuData[category].forEach(item => {
                            const menuItem = document.createElement('div');
                            menuItem.className = 'menu-item';
                            
                            let optionControls = '';
                            let initialOption = 'none'; 
                            
                            if (item.tempOption === 'optional') {
                                initialOption = 'hot'; 
                                optionControls = `
                                    <div class="temp-selection">
                                        <input type="radio" id="temp-hot-${item.id}" name="option-${item.id}" value="hot" checked onchange="updateItemPriceDisplay(${item.id}, 'hot', this.closest('.menu-item'))">
                                        <label for="temp-hot-${item.id}">HOT</label>
                                        <input type="radio" id="temp-ice-${item.id}" name="option-${item.id}" value="ice" onchange="updateItemPriceDisplay(${item.id}, 'ice', this.closest('.menu-item'))">
                                        <label for="temp-ice-${item.id}">ICE</label>
                                    </div>
                                `;
                            } else if (item.tempOption === 'hot' || item.tempOption === 'ice') {
                                initialOption = item.tempOption;
                                optionControls = `<input type="hidden" name="option-${item.id}" value="${item.tempOption}">`;
                            } 
                            else if (item.tempOption === 'flavor' && item.flavors && item.flavors.length > 0) {
                                initialOption = item.flavors[0]; 
                                
                                const flavorInputs = item.flavors.map((flavor, index) => `
                                    <input type="radio" id="flavor-${item.id}-${flavor.replace(/\s/g, '')}" 
                                           name="option-${item.id}" 
                                           value="${flavor}" 
                                           ${index === 0 ? 'checked' : ''} 
                                           onchange="updateItemPriceDisplay(${item.id}, '${flavor}', this.closest('.menu-item'))">
                                    <label for="flavor-${item.id}-${flavor.replace(/\s/g, '')}">${flavor}</label>
                                `).join('');

                                optionControls = `<div class="flavor-selection">${flavorInputs}</div>`;
                            }

                            const quantityElement = `<div class="quantity" id="qty-${item.id}-${initialOption.replace(/\s/g, '')}">0</div>`;

                            menuItem.innerHTML = `
                                <div class="menu-info-group">
                                    <div class="menu-details-line"> 
                                        ${optionControls} <span class="menu-item-name" onclick="selectItem(menuData, ${item.id}, this.closest('.menu-item'))">${item.name}</span>
                                        <span class="menu-item-price" id="price-display-${item.id}">${getPriceText(item.price, initialOption)}</span>
                                    </div>
                                </div>
                                <div class="quantity-controls">
                                    <button onclick="decrementQuantity(event, ${item.id}, this.closest('.menu-item'))">-</button>
                                    ${quantityElement}
                                    <button onclick="incrementQuantity(event, ${item.id}, this.closest('.menu-item'))">+</button>
                                </div>
                            `;
                            section.appendChild(menuItem);
                        });

                        rowDiv.appendChild(section);
                    }
                });

                menuContainer.appendChild(rowDiv);
            });
            updateCartSummary(); 
        }

        // --- ì˜¤ëŠ˜ì˜ ê³„ì‚°ì™• ë¡œì§ (ì•ŒíŒŒë²³ìœ¼ë¡œ ìµœì¢… ë³€ê²½) ---

        /**
         * 1ë‹¨ê³„: ì¸ì› ìˆ˜ë§Œí¼ ì•ŒíŒŒë²³(A, B, C...)ì„ ìƒì„±í•˜ì—¬ ì œì‹œí•©ë‹ˆë‹¤.
         */
        function presentParticipants() {
            const countElement = document.getElementById('participant-count');
            const participantCount = parseInt(countElement.value, 10);
                
            const palette = document.getElementById('participant-palette');
            const selectedSwatch = document.getElementById('selected-participant-swatch');
            const pickButton = document.getElementById('pick-button');
            const presentButton = document.getElementById('present-button');

            // ìƒíƒœ ì´ˆê¸°í™”
            palette.innerHTML = '';
            selectedSwatch.style.backgroundColor = '#E9E9E9';
            selectedSwatch.textContent = '?';
            
            // ë²„íŠ¼ ìƒíƒœ
            pickButton.style.display = 'none';
            presentButton.style.display = 'block';

            // ìœ íš¨ì„± ê²€ì‚¬
            if (isNaN(participantCount) || participantCount < 2) {
                alert("ì°¸ì—¬ ì¸ì› ìˆ˜ëŠ” ìµœì†Œ 2ëª… ì´ìƒìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.");
                return;
            }
            if (participantCount > 26) {
                alert("ì•ŒíŒŒë²³ ê°œìˆ˜ ì œí•œìœ¼ë¡œ ìµœëŒ€ 26ëª…ê¹Œì§€ë§Œ ì§€ì›í•©ë‹ˆë‹¤.");
                return;
            }

            // Aë¶€í„° ì‹œì‘í•˜ëŠ” ì•ŒíŒŒë²³ ìƒì„±
            const participants = [];
            for (let i = 0; i < participantCount; i++) {
                const charCode = 'A'.charCodeAt(0) + i;
                participants.push(String.fromCharCode(charCode));
            }

            // ì „ì—­ ë³€ìˆ˜ì— í˜„ì¬ ì œì‹œëœ ì°¸ê°€ì ëª©ë¡ ì €ì¥
            window.currentParticipants = participants;

            // ì œì‹œëœ ëª¨ë“  ì•ŒíŒŒë²³ì„ íŒ”ë ˆíŠ¸ì— í‘œì‹œ
            participants.forEach((participant, index) => {
                const swatch = document.createElement('div');
                swatch.className = 'participant-swatch';
                swatch.textContent = participant;
                swatch.style.backgroundColor = index % 2 === 0 ? '#EBEBEB' : '#FFFFFF'; 
                
                // ê¸°ì¡´ í•˜ì´ë¼ì´íŠ¸ íš¨ê³¼ ì œê±°
                swatch.style.transform = 'scale(1)';
                swatch.style.borderColor = 'white';
                swatch.style.boxShadow = '0 1px 3px rgba(0,0,0,0.2)';

                palette.appendChild(swatch);
            });

            // ë½‘ê¸° ë²„íŠ¼ í™œì„±í™” ë° ì œì‹œ ë²„íŠ¼ ìˆ¨ê¹€
            pickButton.style.display = 'block';
            presentButton.style.display = 'none';
        }


        /**
         * 2ë‹¨ê³„: ì œì‹œëœ ì°¸ê°€ì ì¤‘ì—ì„œ ë¬´ì‘ìœ„ë¡œ í•˜ë‚˜ë¥¼ ë½‘ì•„ ìµœì¢… ì„ íƒ ìŠ¤ì™€ì¹˜ì— í‘œì‹œí•©ë‹ˆë‹¤. (ì•Œë¦¼ ì œê±°ë¨)
         */
        function pickWinnerParticipant() {
            const participants = window.currentParticipants;
            const palette = document.getElementById('participant-palette');
            const selectedSwatch = document.getElementById('selected-participant-swatch');
            
            // ë²„íŠ¼ ìƒíƒœ ë³€ê²½
            document.getElementById('pick-button').style.display = 'none';
            document.getElementById('present-button').style.display = 'block';


            if (!participants || participants.length === 0) {
                // ì•Œë¦¼ë§Œ ìœ ì§€: ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ë½‘ê¸° ë²„íŠ¼ì„ ëˆŒë €ì„ ë•Œë§Œ ì•Œë¦¼
                alert("ë¨¼ì € 'ì¸ì› ìˆ˜ í™•ì • ë° ì•ŒíŒŒë²³ ì œì‹œ' ë²„íŠ¼ì„ ëˆŒëŸ¬ ì°¸ê°€ìë¥¼ ì œì‹œí•´ì£¼ì„¸ìš”.");
                
                // ë²„íŠ¼ ìƒíƒœ ë³µêµ¬
                document.getElementById('pick-button').style.display = 'block';
                document.getElementById('present-button').style.display = 'none';
                return;
            }

            // ë¬´ì‘ìœ„ë¡œ í•˜ë‚˜ì˜ ì°¸ê°€ì ì„ íƒ
            const randomIndex = Math.floor(Math.random() * participants.length);
            const winningParticipant = participants[randomIndex];
            
            // ìµœì¢… ì„ íƒëœ ì•ŒíŒŒë²³ í‘œì‹œ
            setTimeout(() => {
                selectedSwatch.style.backgroundColor = 'hsl(35, 70%, 75%)'; // ìŠ¹ë¦¬ ìƒ‰ìƒ
                selectedSwatch.textContent = winningParticipant; 
                selectedSwatch.title = `ê³„ì‚°ì™•: ${winningParticipant}`;

                // íŒ”ë ˆíŠ¸ì—ì„œ ì„ íƒëœ ì•ŒíŒŒë²³ í•˜ì´ë¼ì´íŠ¸
                const swatches = palette.querySelectorAll('.participant-swatch');
                swatches.forEach((swatch, index) => {
                    if (index === randomIndex) {
                        swatch.style.transform = 'scale(1.2)';
                        swatch.style.borderColor = 'hsl(25, 45%, 40%)';
                        swatch.style.boxShadow = `0 0 15px hsl(25, 45%, 40%)`;
                        swatch.style.backgroundColor = 'hsl(35, 70%, 75%)';
                    } else {
                        swatch.style.transform = 'scale(1)';
                        swatch.style.borderColor = 'white';
                        swatch.style.boxShadow = '0 1px 3px rgba(0,0,0,0.2)';
                    }
                });

            }, 300); 
        }

        /**
         * ì´ˆê¸° ë¡œë“œ ì‹œ ì‹¤í–‰ë˜ëŠ” í•¨ìˆ˜
         */
        function initializeParticipantInterface() {
             const palette = document.getElementById('participant-palette');
             
             // ì´ˆê¸°ê°’ (4ëª…)ìœ¼ë¡œ íŒ”ë ˆíŠ¸ ë¯¸ë¦¬ êµ¬ì„±
             const initialParticipants = ['A', 'B', 'C', 'D'];
             initialParticipants.forEach((participant, index) => {
                const swatch = document.createElement('div');
                swatch.className = 'participant-swatch';
                swatch.textContent = participant;
                swatch.style.backgroundColor = index % 2 === 0 ? '#EBEBEB' : '#FFFFFF';
                palette.appendChild(swatch);
            });
            
            // ì´ˆê¸° ìƒíƒœì—ì„œëŠ” ë½‘ê¸° ë²„íŠ¼ ìˆ¨ê¹€
            document.getElementById('pick-button').style.display = 'none';
            document.getElementById('present-button').style.display = 'block';

            // ì´ˆê¸° currentParticipants ì„¤ì •
            window.currentParticipants = initialParticipants;
        }


        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë©”ë‰´ ë Œë”ë§ ë° ê³„ì‚°ì™• ì¸í„°í˜ì´ìŠ¤ ì´ˆê¸°í™”
        renderMenu(); 
        initializeParticipantInterface(); 
    </script>
</body>
</html>